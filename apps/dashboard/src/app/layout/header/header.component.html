<header class="bg-white shadow-sm fixed top-0 w-full">
  <div
    class="max-w-4xl mx-auto px-4 py-3 flex items-center justify-between header-inner"
  >
    <div class="flex items-center gap-3">
      <nav class="gap-6 text-sm flex">
        <a routerLink="/" class="font-bold text-lg flex gap-2">
          <svg
            width="20px"
            viewBox="0 0 16 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M2 8L3.33333 6.66667M3.33333 6.66667L8 2L12.6667 6.66667M3.33333 6.66667V13.3333C3.33333 13.7015 3.63181 14 4 14H6M12.6667 6.66667L14 8M12.6667 6.66667V13.3333C12.6667 13.7015 12.3682 14 12 14H10M6 14C6.36819 14 6.66667 13.7015 6.66667 13.3333V10.6667C6.66667 10.2985 6.96514 10 7.33333 10H8.66667C9.03486 10 9.33333 10.2985 9.33333 10.6667V13.3333C9.33333 13.7015 9.63181 14 10 14M6 14H10"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          <span class="sm:flex hidden">Dashboard</span></a
        >
        <a
          routerLink="/audit-log"
          *ngIf="auth.getUserRole() !== 'viewer'"
          class="text-lg flex font-bold gap-2"
          ><svg
            width="20px"
            viewBox="0 0 20 21"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M9.99996 18.8334C14.6023 18.8334 18.3333 15.1025 18.3333 10.5001C18.3333 5.89771 14.6023 2.16675 9.99996 2.16675C5.39759 2.16675 1.66663 5.89771 1.66663 10.5001C1.66663 15.1025 5.39759 18.8334 9.99996 18.8334ZM14.6323 8.41697C14.8625 8.1598 14.8407 7.76468 14.5835 7.53444C14.3263 7.30419 13.9312 7.32602 13.701 7.58319L10.8933 10.7192C10.3244 11.3546 9.94129 11.7803 9.61373 12.0556C9.30168 12.3179 9.1184 12.3751 8.95829 12.3751C8.79819 12.3751 8.61491 12.3179 8.30286 12.0556C7.97529 11.7803 7.59216 11.3546 7.02325 10.7192L6.29894 9.91016C6.06869 9.65299 5.67357 9.63116 5.4164 9.8614C5.15923 10.0916 5.1374 10.4868 5.36765 10.7439L6.1229 11.5875C6.65278 12.1794 7.09474 12.6731 7.49859 13.0125C7.92578 13.3716 8.38656 13.6251 8.95829 13.6251C9.53002 13.6251 9.9908 13.3716 10.418 13.0125C10.8218 12.6731 11.2638 12.1794 11.7937 11.5875L14.6323 8.41697Z"
              fill="currentColor"
            />
          </svg>
          <span class="sm:flex hidden">Audit</span></a
        >
        <a
          routerLink="/users"
          class="text-lg flex font-bold gap-2"
          *ngIf="auth.getUserRole() === 'owner'"
          ><svg
            viewBox="0 0 16 16"
            fill="none"
            width="20px"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M11.3334 13.3333H14.6667V12C14.6667 10.8954 13.7713 10 12.6667 10C12.0296 10 11.4621 10.2979 11.0959 10.7619M11.3334 13.3333H4.66671M11.3334 13.3333V12C11.3334 11.5625 11.2491 11.1447 11.0959 10.7619M4.66671 13.3333H1.33337V12C1.33337 10.8954 2.2288 10 3.33337 10C3.97045 10 4.53795 10.2979 4.9042 10.7619M4.66671 13.3333V12C4.66671 11.5625 4.75099 11.1447 4.9042 10.7619M4.9042 10.7619C5.39571 9.53402 6.59658 8.66667 8.00004 8.66667C9.4035 8.66667 10.6044 9.53402 11.0959 10.7619M10 4.66667C10 5.77124 9.10461 6.66667 8.00004 6.66667C6.89547 6.66667 6.00004 5.77124 6.00004 4.66667C6.00004 3.5621 6.89547 2.66667 8.00004 2.66667C9.10461 2.66667 10 3.5621 10 4.66667ZM14 6.66667C14 7.40305 13.4031 8 12.6667 8C11.9303 8 11.3334 7.40305 11.3334 6.66667C11.3334 5.93029 11.9303 5.33333 12.6667 5.33333C13.4031 5.33333 14 5.93029 14 6.66667ZM4.66671 6.66667C4.66671 7.40305 4.06975 8 3.33337 8C2.59699 8 2.00004 7.40305 2.00004 6.66667C2.00004 5.93029 2.59699 5.33333 3.33337 5.33333C4.06975 5.33333 4.66671 5.93029 4.66671 6.66667Z"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          <span class="sm:flex hidden">Users</span></a
        >
      </nav>
    </div>

    <div class="flex items-center gap-3">
      <button
        class="px-2 py-2 text-sm rounded-md border flex items-center gap-2"
        (click)="toggleTheme()"
        [attr.aria-pressed]="theme.isDark()"
        title="Toggle theme"
      >
        <span *ngIf="theme.isDark(); else light"
          ><svg
            width="14px"
            viewBox="0 0 19 22"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M9.91902 11.0134C8.05089 7.77773 8.39618 4.88815 8.67101 3.0347L8.69962 2.84335C8.75715 2.46024 8.81252 2.09144 8.83128 1.7912C8.8424 1.61306 8.84408 1.41736 8.8135 1.22926C8.78343 1.04435 8.7112 0.79715 8.51717 0.588105C8.07635 0.113182 7.4573 0.245027 7.12294 0.351822C6.7256 0.478732 6.22904 0.730803 5.62655 1.07865C0.484905 4.04718 -1.27675 10.6218 1.69178 15.7634C4.66031 20.9051 11.2349 22.6667 16.3766 19.6982C16.979 19.3503 17.4456 19.0464 17.7542 18.7657C18.0139 18.5295 18.4376 18.0593 18.2467 17.4401C18.1627 17.1676 17.9847 16.9814 17.8396 16.8629C17.692 16.7424 17.5217 16.646 17.3618 16.5665C17.0925 16.4327 16.7454 16.2962 16.3849 16.1545L16.2048 16.0836C14.4622 15.3949 11.7871 14.2491 9.91902 11.0134Z"
              fill="currentColor"
            />
          </svg>
        </span>
        <ng-template #light
          ><svg
            width="16px"
            viewBox="0 0 36 36"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M18 4.5V6M18 30V31.5M31.5 18H30M6 18H4.5M27.5459 27.5459L26.4853 26.4853M9.51472 9.51472L8.45406 8.45406M27.546 8.45414L26.4854 9.5148M9.5148 26.4854L8.45414 27.546M24 18C24 21.3137 21.3137 24 18 24C14.6863 24 12 21.3137 12 18C12 14.6863 14.6863 12 18 12C21.3137 12 24 14.6863 24 18Z"
              stroke="currentColor"
              stroke-width="2.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </ng-template>
        <span class="sr-only">Toggle theme</span>
      </button>
      <ng-container *ngIf="!auth.isLoggedIn(); else logged">
        <a routerLink="/login" class="px-3 py-1 border rounded-md text-sm">
          Login
        </a>
      </ng-container>
      <ng-template #logged>
        <div class="relative">
          <button
            #profileBtn
            class="profile-button"
            (click)="profileOpen = !profileOpen"
            title="Account"
          >
            <svg
              width="16px"
              viewBox="0 0 16 16"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M10.1668 5.99992C10.1668 7.19654 9.19678 8.16659 8.00016 8.16659V9.16659C9.74906 9.16659 11.1668 7.74882 11.1668 5.99992H10.1668ZM8.00016 8.16659C6.80355 8.16659 5.8335 7.19654 5.8335 5.99992H4.8335C4.8335 7.74882 6.25126 9.16659 8.00016 9.16659V8.16659ZM5.8335 5.99992C5.8335 4.8033 6.80355 3.83325 8.00016 3.83325V2.83325C6.25126 2.83325 4.8335 4.25102 4.8335 5.99992H5.8335ZM8.00016 3.83325C9.19678 3.83325 10.1668 4.8033 10.1668 5.99992H11.1668C11.1668 4.25102 9.74906 2.83325 8.00016 2.83325V3.83325ZM6.00016 11.1666H10.0002V10.1666H6.00016V11.1666ZM1.8335 7.99992C1.8335 4.59416 4.59441 1.83325 8.00016 1.83325V0.833252C4.04212 0.833252 0.833496 4.04188 0.833496 7.99992H1.8335ZM8.00016 1.83325C11.4059 1.83325 14.1668 4.59416 14.1668 7.99992H15.1668C15.1668 4.04188 11.9582 0.833252 8.00016 0.833252V1.83325ZM14.1668 7.99992C14.1668 9.74878 13.4395 11.3269 12.2694 12.4498L12.9618 13.1713C14.3202 11.8677 15.1668 10.0322 15.1668 7.99992H14.1668ZM12.2694 12.4498C11.1609 13.5136 9.65733 14.1666 8.00016 14.1666V15.1666C9.92562 15.1666 11.6746 14.4066 12.9618 13.1713L12.2694 12.4498ZM10.0002 11.1666C11.0509 11.1666 11.9279 11.915 12.1252 12.908L13.106 12.7131C12.8175 11.2611 11.5372 10.1666 10.0002 10.1666V11.1666ZM8.00016 14.1666C6.34299 14.1666 4.83939 13.5136 3.73091 12.4498L3.0385 13.1713C4.32571 14.4066 6.07471 15.1666 8.00016 15.1666V14.1666ZM3.73091 12.4498C2.56085 11.3269 1.8335 9.74878 1.8335 7.99992H0.833496C0.833496 10.0322 1.68009 11.8677 3.0385 13.1713L3.73091 12.4498ZM6.00016 10.1666C4.46313 10.1666 3.18285 11.2611 2.8943 12.7131L3.87511 12.908C4.07247 11.915 4.94947 11.1666 6.00016 11.1666V10.1666Z"
                fill="currentColor"
              />
            </svg>
          </button>

          <div *ngIf="profileOpen" #profileMenu class="profile-menu">
            <div>
              <div class="text-sm font-medium">
                {{ auth.getUserName() || profileUser?.username }}
              </div>
              <div class="text-xs text-gray-500">
                {{ profileUser?.organization?.name || 'No organization' }}
              </div>
            </div>
            <div>
              <button
                (click)="logout(); profileOpen = false"
                class="w-full text-left px-2 py-2 rounded"
              >
                <svg
                  width="16px"
                  viewBox="0 0 16 16"
                  color="#E24744"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.3333 10.667L14 8.00033M14 8.00033L11.3333 5.33366M14 8.00033L4.66667 8.00032M8.66667 10.667V11.3337C8.66667 12.4382 7.77124 13.3337 6.66667 13.3337H4C2.89543 13.3337 2 12.4382 2 11.3337V4.66699C2 3.56242 2.89543 2.66699 4 2.66699H6.66667C7.77124 2.66699 8.66667 3.56242 8.66667 4.66699V5.33366"
                    stroke="currentColor"
                    stroke-width="1.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </ng-template>
    </div>
  </div>
</header>
