<app-header></app-header>
<div class="max-w-6xl mx-auto p-4">
  <h2 class="text-xl font-semibold mb-4">User Management</h2>

  <div *ngIf="loading">Loading users...</div>

  <div class="panel panel-form mt-6">
    <h3>Create new user</h3>
    <div class="grid grid-cols-1 sm:grid-cols-4 gap-2">
      <input
        class="p-2 border"
        placeholder="username"
        [(ngModel)]="newUsername"
      />
      <input
        class="p-2 border"
        placeholder="email"
        [(ngModel)]="newEmail"
        type="email"
      />
      <input
        class="p-2 border"
        placeholder="password"
        [(ngModel)]="newPassword"
        type="password"
      />
      <select
        [(ngModel)]="newRole"
        class="border block w-full px-3 py-2 border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
      >
        <option value="viewer">viewer</option>
        <option value="admin">admin</option>
      </select>
    </div>
    <div class="mt-3 flex justify-end">
      <button
        class="px-3 py-2 rounded border text-white btn-accent"
        (click)="create()"
      >
        Create
      </button>
    </div>
  </div>
  <div class="overflow-x-auto hide-scrollbar">
    <table
      class="w-full table-auto border-collapse rounded-2xl data-table"
      *ngIf="!loading"
    >
      <thead>
        <tr class="text-left">
          <th class="px-2 py-2 text-center">Username</th>
          <th class="px-2 py-2 text-center">Email</th>
          <th class="px-2 py-2 text-center">Role</th>
          <th class="px-2 py-2 text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let u of users" class="row-sep">
          <td class="px-2 py-2 text-center">{{ u.username }}</td>
          <td class="px-2 py-2 text-center">{{ u.email }}</td>
          <td class="px-2 py-2 text-center">
            <select
              [value]="u.role"
              (change)="updateRole(u, $any($event.target).value)"
            >
              <option value="admin">admin</option>
              <option value="viewer">viewer</option>
            </select>
          </td>
          <td class="px-2 py-1 text-center">
            <button
              class="px-2 py-1 border rounded text-sm"
              (click)="remove(u.id)"
              style="background-color: #e24744"
            >
              <svg
                color="white"
                width="16"
                viewBox="0 0 16 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M13.4317 9.64941L14.0507 9.73556L14.0507 9.73556L13.4317 9.64941ZM13.213 11.2203L13.8321 11.3064L13.8321 11.3064L13.213 11.2203ZM2.78826 11.2203L3.4073 11.1341L3.4073 11.1341L2.78826 11.2203ZM2.56965 9.64942L1.95062 9.73557L1.95062 9.73557L2.56965 9.64942ZM5.65369 17.1139L5.4107 17.6897L5.4107 17.6897L5.65369 17.1139ZM3.39655 14.4668L3.98321 14.2512L3.98321 14.2512L3.39655 14.4668ZM12.6047 14.4668L13.1914 14.6823L13.1914 14.6823L12.6047 14.4668ZM10.3476 17.1139L10.1046 16.538L10.1046 16.538L10.3476 17.1139ZM2.78952 6.44072C2.75687 6.09709 2.45183 5.84499 2.1082 5.87764C1.76457 5.91029 1.51247 6.21532 1.54512 6.55895L2.78952 6.44072ZM14.4562 6.55895C14.4888 6.21532 14.2367 5.91029 13.8931 5.87764C13.5495 5.84499 13.2444 6.09709 13.2118 6.44072L14.4562 6.55895ZM14.6673 5.45817C15.0125 5.45817 15.2923 5.17835 15.2923 4.83317C15.2923 4.48799 15.0125 4.20817 14.6673 4.20817V5.45817ZM1.33398 4.20817C0.988806 4.20817 0.708984 4.48799 0.708984 4.83317C0.708984 5.17835 0.988806 5.45817 1.33398 5.45817V4.20817ZM5.70898 13.9998C5.70898 14.345 5.98881 14.6248 6.33398 14.6248C6.67916 14.6248 6.95898 14.345 6.95898 13.9998H5.70898ZM6.95898 7.33317C6.95898 6.98799 6.67916 6.70817 6.33398 6.70817C5.98881 6.70817 5.70898 6.98799 5.70898 7.33317H6.95898ZM9.04232 13.9998C9.04232 14.345 9.32214 14.6248 9.66732 14.6248C10.0125 14.6248 10.2923 14.345 10.2923 13.9998H9.04232ZM10.2923 7.33317C10.2923 6.98799 10.0125 6.70817 9.66732 6.70817C9.32214 6.70817 9.04232 6.98799 9.04232 7.33317H10.2923ZM11.334 4.83317V5.45817H11.959V4.83317H11.334ZM4.66732 4.83317H4.04232V5.45817H4.66732V4.83317ZM13.4317 9.64941L12.8126 9.56326L12.594 11.1341L13.213 11.2203L13.8321 11.3064L14.0507 9.73556L13.4317 9.64941ZM2.78826 11.2203L3.4073 11.1341L3.18869 9.56327L2.56965 9.64942L1.95062 9.73557L2.16923 11.3064L2.78826 11.2203ZM8.00065 17.3332V16.7082C6.72635 16.7082 6.27185 16.6963 5.89668 16.538L5.65369 17.1139L5.4107 17.6897C6.07494 17.97 6.83863 17.9582 8.00065 17.9582V17.3332ZM2.78826 11.2203L2.16923 11.3064C2.40232 12.9813 2.52904 13.9179 2.8099 14.6823L3.39655 14.4668L3.98321 14.2512C3.76028 13.6445 3.64941 12.8738 3.4073 11.1341L2.78826 11.2203ZM5.65369 17.1139L5.89668 16.538C5.12798 16.2137 4.41312 15.4213 3.98321 14.2512L3.39655 14.4668L2.8099 14.6823C3.32207 16.0763 4.2357 17.1939 5.4107 17.6897L5.65369 17.1139ZM13.213 11.2203L12.594 11.1341C12.3519 12.8738 12.241 13.6445 12.0181 14.2512L12.6047 14.4668L13.1914 14.6823C13.4723 13.9179 13.599 12.9813 13.8321 11.3064L13.213 11.2203ZM8.00065 17.3332V17.9582C9.16267 17.9582 9.92636 17.97 10.5906 17.6897L10.3476 17.1139L10.1046 16.538C9.72945 16.6963 9.27496 16.7082 8.00065 16.7082V17.3332ZM12.6047 14.4668L12.0181 14.2512C11.5882 15.4213 10.8733 16.2137 10.1046 16.538L10.3476 17.1139L10.5906 17.6897C11.7656 17.1939 12.6792 16.0763 13.1914 14.6823L12.6047 14.4668ZM2.56965 9.64942L3.18869 9.56327C3.00358 8.2332 2.86536 7.23902 2.78952 6.44072L2.16732 6.49984L1.54512 6.55895C1.62414 7.39064 1.76699 8.41613 1.95062 9.73557L2.56965 9.64942ZM13.4317 9.64941L14.0507 9.73556C14.2343 8.41612 14.3772 7.39064 14.4562 6.55895L13.834 6.49984L13.2118 6.44072C13.1359 7.23902 12.9977 8.23319 12.8126 9.56326L13.4317 9.64941ZM14.6673 4.83317V4.20817H1.33398V4.83317V5.45817H14.6673V4.83317ZM6.33398 13.9998H6.95898V7.33317H6.33398H5.70898V13.9998H6.33398ZM9.66732 13.9998H10.2923V7.33317H9.66732H9.04232V13.9998H9.66732ZM11.334 3.99984H10.709V4.83317H11.334H11.959V3.99984H11.334ZM11.334 4.83317V4.20817H4.66732V4.83317V5.45817H11.334V4.83317ZM4.66732 4.83317H5.29232V3.99984H4.66732H4.04232V4.83317H4.66732ZM8.00065 0.666504V1.2915C9.49642 1.2915 10.709 2.50407 10.709 3.99984H11.334H11.959C11.959 1.81371 10.1868 0.0415039 8.00065 0.0415039V0.666504ZM8.00065 0.666504V0.0415039C5.81452 0.0415039 4.04232 1.81371 4.04232 3.99984H4.66732H5.29232C5.29232 2.50407 6.50488 1.2915 8.00065 1.2915V0.666504Z"
                  fill="currentColor"
                />
              </svg>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
